<Target Name="GenerateProjection" BeforeTargets="Build">
    <PropertyGroup>
        <CsWinRTParams>
            # This sample demonstrates using a response file for cswinrt execution.
            # Run "cswinrt -h" to see all command line options.
            -verbose
            # Include Windows SDK metadata to satisfy references to 
            # Windows types from project-specific metadata.
            -in 10.0.18362.0
            # Don't project referenced Windows types, as these are 
            # provided by the Windows interop assembly.
            -exclude Windows 
            # Reference project-specific winmd files, defined elsewhere,
            # such as from a NuGet package.
            -in @(ContosoWinMDs->'"%(FullPath)"', ' ')
            # Include project-specific namespaces/types in the projection
            -include Contoso 
            # Write projection sources to the "Generated Files" folder,
            # which should be excluded from checkin (e.g., .gitignored).
            -out "$(ProjectDir)Generated Files"
        </CsWinRTParams>
    </PropertyGroup>
    <WriteLinesToFile
        File="$(CsWinRTResponseFile)" Lines="$(CsWinRTParams)"
        Overwrite="true" WriteOnlyWhenDifferent="true" />
    <Message Text="$(CsWinRTCommand)" Importance="$(CsWinRTVerbosity)" />
    <Exec Command="$(CsWinRTCommand)" />
</Target>

<Target Name="IncludeProjection" BeforeTargets="CoreCompile" AfterTargets="GenerateProjection">
    <ItemGroup>
        <Compile Include="$(ProjectDir)Generated Files/*.cs" Exclude="@(Compile)" />
    </ItemGroup>
</Target>
